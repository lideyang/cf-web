define(function(require,exports,module){var $=require("jquery"),e=require("tools");require("jquery.validate"),require("jquery.CountDown"),require("jquery.select");var a={selectContactUrl:basePath+"/transfer/getMyContact.json",allContactUrl:basePath+"/transfer/getMyContact.json?toLogidId=",checkPayeeUserUrl:basePath+"/transfer/checkPayeeUser.json"};module.exports={config:function(e){a=$.extend({},a,e)},init:function(){$("#navTabs").on("click",".tabs",function(){var e=$(this).index();$(this).addClass("active").siblings().removeClass("active"),$("#tabsContent").find(".tableTransfer").hide().eq(e).show()})},toAccount:function(){function t(e){$.ajax({type:"GET",url:a.allContactUrl+e,dataType:"JSON",async:!1,success:function(e,a){var t=$("#contactList");if(t.text(""),"200"==e.code){var n=e.data;$("#contactSize").text(n.length);for(var s=0;s<n.length;s++)t.append('<p class=\'list\'><input type="radio" name="contacts" data-UserName="'+n[s].linkMan+'" data-UserNo="'+n[s].linkLoginId+'"/>'+n[s].linkMan+"  |  ****"+n[s].linkLoginId.toString().substr(8)+"</p>");n.length>0?$("#contacts").siblings("#popup").fadeIn():$("#contacts").siblings("#popup").fadeOut(),$("#contactList").on("click","p.list",function(){var e=$(this).find("input:radio");$("#payeeUserNo").val(e.attr("data-UserNo")),$("#payeeUserName").val(e.attr("data-UserName")),$("#payeeUserNo").html('<option value="'+e.attr("data-UserNo")+'">'+e.attr("data-UserNo")+"</option>"),$("#payeeUserNo").val(e.attr("data-UserNo")),$("#contactsBox").find(".combo-input").val(e.attr("data-UserNo")).trigger("blur"),$("#contacts").siblings("#popup").fadeOut(),$("#transferForm").validate().element($("#payeeUserNo")),$("#userNameAlert").hide()})}else t.text(e.message)}})}""!=sendMsgFlag&&"undefined"!=sendMsgFlag||$("#chkNoticeInput").val(0),"1"==sendMsgFlag&&($("#chkNotice").addClass("checkboxOn"),$(".inpNotice").slideDown(),$("#phoneNumber").rules("add",{required:!0,isMobile:!0})),$("#payeeUserNo").on("blur.select",function(){var e=$("#transferForm").validate();e.element("#payeeUserNo")||$("#payeeUserName").val("")}),$("#payeeUserNo").comboSelect({ajax:a.selectContactUrl});var n="";$("#payeeUserNo").on("blur",function(){""!=n&&"200"==n.code&&""==n.loginId||null==n.loginId?$("#userNameText").hide():"500"==n.code&&$("#payeeUserName").val("")}),$("#contacts").on("click",function(){t("")}),$("#transferForm").validate({rules:{payeeUserNo:{required:!0,isName:!0,remote:{type:"GET",url:a.checkPayeeUserUrl,cache:!1,data:{toLogidId:function(){return $("#payeeUserNo").val()}},complete:function(e){if(n=e=$.parseJSON(e.responseText),"200"==e.code){var a=e.data.loginId,t=e.data.name;""!=a&&null!=a?$("#payeeUserName").val(t):($("#payeeUserName").val(""),$("#userNameText").html('<em class="miss"></em><label id="payeeUserName-error" class="error miss" for="payeeUserName">收款人未开通账号，您可继续转账。</label>').show())}else if("500"==e.code){var s=e.data.status;""!=s&&null!=s?$("#payeeUserNoText").html('<em></em><label id="payeeUserNo-error" class="error" for="payeeUserNo">此账户已'+s+"。</label>").show():$("#payeeUserNoText").hide(),$("#payeeUserName").val(""),$("#userNameText").hide()}}}},payeeUserName:{},amtB:{required:!0,isNumber:!0,min:.01,rechargeAmtLimit:rechargeAmtLimit},phoneNumber:{isMobile:!0},remark:{required:!0}},messages:{payeeUserNo:{required:"请输入收款人账户",isName:"收款人账户不正确",remote:"此账户已冻结"},payeeUserName:{required:"请输入收款人姓名",minlength:"姓名不正确"},amtB:{required:"请输入转账金额",min:"转账金额不正确",rechargeAmtLimit:"转账金额不可大于本次可转账金额",cashAmt:"转账金额不可大于当日可转账余额",isNumber:"转账金额不正确"},phoneNumber:{required:"请输入手机号码",isMobile:"手机号码不正确"},remark:{maxlength:"长度不正确"}},debug:!0,ignore:"#PWD,#amtA",hiddenInput:"amtB",errorPlacement:function(e,a){var t=$(a);"payeeUserNo"==t.attr("id"),t.addClass("myInputBlur").parent().find(".alertText").addClass("alertTextFocus").html("<em></em>").append(e).css("display","inline")},success:function(e,a){$(a).removeClass("alertTextFocus myInputBlur").parent().find(".alertText").removeClass("alertTextFocus").empty()},submitHandler:function(e){$(e)[0].submit()}}),e.moneyFixInput(),$("#chkNotice").click(function(){$(this).hasClass("checkboxOn")?($(this).parent().parent().find(".inpNotice").slideUp().children("input").removeClass("inpRequired"),$("#chkNoticeInput").val("0"),$("#phoneNumber").rules("remove")):($(this).parent().parent().find(".inpNotice").slideDown().children("input").addClass("inpRequired"),$("#chkNoticeInput").val("1"),$("#phoneNumber").rules("add",{required:!0,isMobile:!0}))});var s=$("#windowClose"),r=($("#popup"),$("#contacts"));r.click(function(){$(this).siblings("#popup").fadeIn()}),s.click(function(){$(this).parents("#popup").fadeOut()}),$("#popup :radio").click(function(){$(this).parents("#popup").fadeOut()}),$(document).on("click",function(e){"contacts"!=e.target.id&&"popup"!=e.target.id&&$("#popup").fadeOut()})},toBankCard:function(){function a(e){$.ajax({type:"GET",url:basePath+"/static/mocks/select.json?toLogidId="+e,dataType:"JSON",async:!1,success:function(e,a){var t=$("#cardContactList");if(t.text(""),"200"==e.code){var n=e.data;$("#cardContactSize").text(n.length);for(var s=0;s<n.length;s++)t.append('<p class=\'list\'><input type="radio" name="contacts" data-UserName="'+n[s].linkMan+'" data-UserNo="'+n[s].linkLoginId+'"/>'+n[s].linkMan+"  |  ****"+n[s].linkLoginId.toString().substr(8)+"</p>");n.length>0?$("#contacts").siblings("#popup").fadeIn():$("#contacts").siblings("#popup").fadeOut(),$("#contactList").on("click","p.list",function(){var e=$(this).find("input:radio");$("#payeeUserNo").val(e.attr("data-UserNo")),$("#payeeUserName").val(e.attr("data-UserName")),$("#contacts").siblings("#popup").fadeOut(),$("#transferForm").validate().element($("#payeeUserNo")),$("#userNameAlert").hide()})}else t.text(e.message)}})}var t=$("#windowClose2"),n=$("#popup2"),s=$("#contacts2");n.fadeOut(),s.click(function(){$(this).siblings("#popup2").fadeIn()}),t.click(function(){$(this).parents("#popup2").fadeOut()}),$("#popup2 :radio").click(function(){$(this).parents("#popup2").fadeOut()}),$("#chkNotice2").click(function(){$(this).hasClass("checkboxOn")?($(".inpNotice2").slideDown(),$(".inpNotice2").children("input").addClass("inpRequired")):($(".inpNotice2").slideUp(),$(".inpNotice2").children("input").removeClass("inpRequired"))}),$("#cardNo").comboSelect({ajax:basePath+"/static/mocks/bankCard.json"}),$("#transferForm02").validate({rules:{bankUserNo:{required:!0,isEmail:!0},bankName:{minlength:1},bankTpye:{},bankUserName:{required:!0,minlength:1},bankamtA:{required:!0,byteRangeLength:[3,30]},bankPhoneNumber:{isMobile:!0},bankRemark:{maxlength:15}},messages:{bankUserNo:{required:"请输入收款人账户",isEmail:"收款人账户邮箱"},bankName:{minlength:"银行必须选择"},bankTpye:{},bankUserName:{required:"请输入收款人姓名",minlength:"姓名不正确"},bankamtA:{required:"请输入转账金额",byteRangeLength:"金额不正确"},bankPhoneNumber:{isMobile:"手机号不正确"},bankRemark:{maxlength:"长度不正确"}},ignore:"#PWD",errorPlacement:function(e,a){var t=$(a);"payeeUserNo"==t.attr("id")?t.addClass("myInputBlur").parent().parent().find(".alertText").addClass("alertTextFocus").html("<em></em>").append(e).css("display","inline"):t.addClass("myInputBlur").parent().find(".alertText").addClass("alertTextFocus").html("<em></em>").append(e).css("display","inline")},success:function(e,a){var t=$(a);"payeeUserNo"==t.attr("id")?$(a).removeClass("alertTextFocus myInputBlur").parent().parent().find(".alertText").removeClass("alertTextFocus").empty():$(a).removeClass("alertTextFocus myInputBlur").parent().find(".alertText").removeClass("alertTextFocus").empty()},submitHandler:function(e){$(e)[0].submit()}}),e.moneyFixInput("#cardAmtA","cardAmtB"),$("#cardNotice").on("click",function(){$(this).hasClass("checkboxOn")?($(this).parent().parent().find(".inpNotice").slideUp().children("input").removeClass("inpRequired"),$("#cardNoticeInput").val("0")):($(this).parent().parent().find(".inpNotice").slideDown().children("input").addClass("inpRequired"),$("#cardNoticeInput").val("1"))}),$("#cardContacts").on("click",function(){a($("#payeeUserNo").val())})}}});